<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Marketing Insights Bot for {{ company_name }}</title>
  <!-- Markdown parser for formatting AI responses -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
  <!-- Dynamic favicon using company icon -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>{{ company_icon }}</text></svg>">
</head>
<body>
  <div class="container">
    <!-- Header section -->
    <div class="header">
      <h1>Marketing Insights Bot - {{ company_name }}</h1>
      <div class="status-bar">
        <div class="control-buttons">
          <button id="background-btn" class="control-btn">📝 Background</button>
          <button id="clear-history-btn" class="control-btn">🗑️ Clear History</button>
        </div>
      </div>
    </div>

    <!-- Company Background Section (hidden by default) -->
    <div id="background-section" class="background-section" style="display: none;">
      <div class="background-header">
        <h3>Company Background</h3>
        <div class="background-controls">
          <button id="edit-background-btn" class="edit-btn">✏️ Edit</button>
          <button id="save-background-btn" class="save-btn" style="display: none;">💾 Save</button>
          <button id="cancel-background-btn" class="cancel-btn" style="display: none;">❌ Cancel</button>
          <button id="reset-background-btn" class="reset-btn">🔄 Reset</button>
        </div>
      </div>
      <div id="background-display" class="background-display"></div>
      <textarea id="background-editor" class="background-editor" style="display: none;" 
                maxlength="2000" placeholder="Enter company background..."></textarea>
      <div class="background-info">
        <span id="background-status"></span>
        <span id="character-count"></span>
      </div>
    </div>
    
    <!-- Chat conversation area -->
    <div id="chat-box"></div>
    
    <!-- User input form -->
    <form id="prompt-form">
      <textarea id="prompt-input" rows="2" 
                placeholder="Ask a question about marketing strategy..." required></textarea>
      <button type="submit" id="send-btn">Send</button>
    </form>
    
    <!-- Stop generation button (hidden by default) -->
    <button id="stop-button">Stop</button>
  </div>
  
  <!-- Store company ID for JavaScript access -->
  <script>
    window.COMPANY_ID = '{{ company_id }}';
  </script>
  
  <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
